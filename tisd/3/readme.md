1. программа заканчивается при каждой ошибке кто так сделал
2. тут генерируется табличка в файл аутпут, ее можно в отчет вставлять
3. тут дофига мемори ликс

это очень стремный код мне за него стыдно, правда
